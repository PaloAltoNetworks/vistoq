name: addon-edl
label: IP EDL for Minemeld
description: EDL config
type: service
extends:

labels:
  service_type: addon

variables:
  - name: FW_NAME
    description: device name for device-group and template-stack association
    default: paloalto
    type_hint: text
  - name: EDL_NAME
    description: EDL name
    default: Minemeld
    type_hint: ip_address
  - name: EDL_URL
    description: EDL URL
    default: http://edl.url
    type_hint: text
  - name: EDL_RULE_NAME
    description: EDL rule name
    default: Minemeld
    type_hint: text


snippets:
  - name: external_list
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{ FW_NAME }}']/external-list
    file: external_list.xml
  - name: pre_rulebase_security
    xpath: /config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='{{ FW_NAME }}']/pre-rulebase/security
    file: pre_rulebase_security.xml